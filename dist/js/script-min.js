"use strict";let services=document.querySelector(".calculator-services"),slider=document.querySelector("#volume"),slider_min=document.querySelector(".calculator-slider__value--min"),slider_max=document.querySelector(".calculator-slider__value--max"),slider_value=document.querySelector(".slider-value"),intres_value=document.querySelector(".intres-value"),instalment=document.querySelector("#instalment"),contract_value=document.querySelector(".contract-value"),contract_free=document.querySelector(".contract-fee"),contract_period=document.querySelector(".contract-period"),contract_total=document.querySelector(".contract-total"),period_select=document.querySelector("#period"),monthly_payment=document.querySelector(".monthly-payment");async function getResponse(){let e=await fetch("../data.json"),t=await e.json();for(let e in t)for(let r in t[e]){let l=document.createElement("label"),n=document.createElement("input"),i=document.createElement("span");n.setAttribute("type","checkbox"),l.classList.add("service-item"),i.classList.add("checkmark"),l.innerHTML=t[e][r].name,services.append(l),l.append(n),l.append(i),n.addEventListener("change",function(){if(n.checked){let i=document.querySelectorAll("input[type=checkbox]");for(let e of i)e.checked=!1,e.parentElement.style.background="white";if(n.checked=!0,n.parentElement.style.background="#f7fafa",this.parentElement.textContent===t[e][r].name){slider.setAttribute("min",t[e][r].price_range[0]),slider.setAttribute("max",t[e][r].price_range[1]),slider_min.innerHTML=t[e][r].price_range[0]+" €",slider_max.innerHTML=t[e][r].price_range[1]+" €",slider.value=t[e][r].default_value,slider_value.value=t[e][r].default_value,contract_period.innerHTML=t[e][r].default_period+" kuud";let n=0,i=0,a=0;function l(){let l=0;for(let o in t[e][r].intres){l++;let u=Number(slider.value);0==a?slider_value.value=u:(slider_value.value=a,slider.value=a);let c=o.split("-")[0],d=o.split("-")[1];if(u>c&&u<d){intres_value.innerHTML=t[e][r].intres[o],contract_value.innerHTML=t[e][r].contract_fee[l-1]+" €",contract_free.innerHTML=t[e][r].monthly_fee[l-1]+" €";let a,u,c,d=period_select.querySelectorAll("option");for(let e of d)e.remove();for(let i=1;i<=t[e][r].period[l-1]/6;i++){let l=document.createElement("option");l.innerHTML=6*i+" kuud",period_select.append(l),period_select.value=0==n?t[e][r].default_period+" kuud":n+" kuud"}a=0==n?(Number(slider.value)*t[e][r].intres[o].split("%")[0]/100+Number(slider.value)-i)/t[e][r].default_period:(Number(slider.value)*t[e][r].intres[o].split("%")[0]/100+Number(slider.value)-i)/n,u=0==n?t[e][r].contract_fee[l-1]/t[e][r].default_period:t[e][r].contract_fee[l-1]/n;let s=t[e][r].monthly_fee[l-1];c=0==n?(a+u+s)*t[e][r].default_period:(a+u+s)*n,monthly_payment.innerHTML=(a+u+s).toFixed(2)+" €",contract_total.innerHTML=c.toFixed(2)+" €"}}}l(),period_select.value=t[e][r].default_period+" kuud",period_select.addEventListener("input",function(){contract_period.innerHTML=period_select.value,n=Number(period_select.value.split("kuud")[0]),l()}),slider.addEventListener("input",function(){a=slider.value,l()}),instalment.addEventListener("focusout",function(){(i=Number(instalment.value))>slider.value?(i=0,instalment.style.borderBottom="3px solid #e03416",instalment.value=0):instalment.style.borderBottom="3px solid #99a0a6",l()}),slider_value.addEventListener("focusout",function(){a=slider_value.value,l()})}}})}}getResponse();